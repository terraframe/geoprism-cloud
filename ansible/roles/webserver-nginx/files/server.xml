<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!--
    Copyright (c) 2015 TerraFrame, Inc. All rights reserved.

    This file is part of Runway SDK(tm).

    Runway SDK(tm) is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    Runway SDK(tm) is distributed in the hope that it will be useful, but
    WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with Runway SDK(tm).  If not, see <http://www.gnu.org/licenses/>.
-->

<Server port="-1" shutdown="SHUTDOWN">

  <Listener className="org.apache.catalina.startup.VersionLoggerListener" />
  <!--
  <Listener className="org.apache.catalina.security.SecurityListener" />
  -->
  <Listener className="org.apache.catalina.core.JreMemoryLeakPreventionListener" />
  <Listener className="org.apache.catalina.mbeans.GlobalResourcesLifecycleListener" />
  <Listener className="org.apache.catalina.core.ThreadLocalLeakPreventionListener" />

  <GlobalNamingResources>
    <Resource
      auth="Container"
      description="User database that can be updated and saved"
      factory="org.apache.catalina.users.MemoryUserDatabaseFactory"
      name="UserDatabase"
      pathname="conf/tomcat-users.xml"
      type="org.apache.catalina.UserDatabase" />
  </GlobalNamingResources>

  <Service name="Catalina">

    <!--
      Nginx terminates TLS on :443 and proxies to Tomcat over plain HTTP.
      So Tomcat only needs one HTTP connector.
    -->
    <Connector
	  protocol="org.apache.coyote.http11.Http11NioProtocol"
	  port="8080"
	  enableLookups="false"
	  maxThreads="400"
	  scheme="https"
	  secure="true"
	  proxyPort="443"
	/>

    <Engine defaultHost="localhost" name="Catalina">

      <Realm className="org.apache.catalina.realm.LockOutRealm">
        <Realm
          className="org.apache.catalina.realm.UserDatabaseRealm"
          resourceName="UserDatabase"/>
      </Realm>

      <Host
        appBase="webapps"
        autoDeploy="false"
        name="localhost"
        unpackWARs="true"
        xmlNamespaceAware="false"
        xmlValidation="false">

        <Valve
          className="org.apache.catalina.valves.AccessLogValve"
          directory="logs"
          pattern="%h %l %u %t &quot;%r&quot; %s %b"
          prefix="localhost_access_log."
          resolveHosts="false"
          suffix=".txt" />
      </Host>
    </Engine>
  </Service>
</Server>
